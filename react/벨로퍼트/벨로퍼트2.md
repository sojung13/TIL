### 11. ë°°ì—´ ë Œë”ë§í•˜ê¸°

```react
import React from 'react';

function User({ user }) {
  return (
    <div>
      <b>{user.username}</b> <span>({user.email})</span>
    </div>
  );
}

// í•œ íŒŒì¼ ì•ˆì— ì—¬ëŸ¬ ê°œì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ì„ ì–¸í•´ë„ ê´œì°®ë‹¤!!
function UserList() {
  const users = [
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com'
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com'
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com'
    }
  ];

  return (
    <div>
      {users.map(user => (
        // ë¦¬ì•¡íŠ¸ì—ì„œ ë°°ì—´ì„ ë Œë”ë§í•  ë•ŒëŠ” keyë¼ëŠ” propsë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤.
        // key ê°’ì€ ê° ì›ì†Œë“¤ë§ˆë‹¤ ê°€ì§€ê³  ìˆëŠ” ê³ ìœ ê°’ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤!!
        // ì§€ê¸ˆì˜ ê²½ìš°ëŠ” idê°€ ê³ ìœ ê°’ì´ì§€ë§Œ, idê°€ ì—†ëŠ” ê²½ìš° ì•„ë˜ ì„¤ëª… ì°¸ì¡°
        <User user={user} key={user.id} />
      ))}
    </div>
  );
}

export default UserList;
```

- `map`ì€ ë°°ì—´ ì•ˆì˜ ê° ì›ì†Œë¥¼ ë³€í™˜í•  ë•Œ ì‚¬ìš©ë˜ë©°, ì´ ê³¼ì •ì—ì„œ ìƒˆë¡œìš´ ë°°ì—´ì´ ë§Œë“¤ì–´ì§„ë‹¤.



- ğŸ‘‰ idê°’ì´ ì—†ì–´ key ê°’ì„ ì„¤ì • ëª»í•  ë•ŒëŠ” ì½œë°± í•¨ìˆ˜ì˜ ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ indexë¥¼ keyë¡œ ì„¤ì •í•˜ë©´ ëœë‹¤.

```react
<div>
  {users.map((user, index) => (
    <User user={user} key={index} />
  ))}
</div>
```

- key ê°’ì„ ì„¤ì •í•´ì£¼ì§€ ì•Šìœ¼ë©´, ìˆ˜ì •ë˜ì§€ ì•Šì€ ê¸°ì¡´ì˜ ê°’ì€ ê·¸ëŒ€ë¡œ ë‘ê³  ì›í•˜ëŠ” ê³³ì— ë‚´ìš©ì„ ì‚½ì…í•˜ê±°ë‚˜ ì‚­ì œê°€ ê°€ëŠ¥í•˜ë‹¤. ì¦‰, ë¹„íš¨ìœ¨ì ì¸ ìˆ˜ì •ì„ í”¼í•  ìˆ˜ ìˆë‹¤!!



----



### 12. useRefë¡œ ì»´í¬ë„ŒíŠ¸ ì•ˆì˜ ë³€ìˆ˜ ë§Œë“¤ê¸°

- `useRef` HOOKì€ DOMì„ ì„ íƒí•˜ëŠ” ìš©ë„ ì™¸ì—ë„, ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì¡°íšŒ ë° ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ë³€ìˆ˜ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
- `useRef`ë¡œ ê´€ë¦¬í•˜ëŠ” ë³€ìˆ˜ëŠ” ê°’ì´ ë°”ë€ë‹¤ê³  í•´ì„œ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
- ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ì„œì˜ ìƒíƒœëŠ” ìƒíƒœë¥¼ ë°”ê¾¸ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ë‚˜ì„œ ê·¸ ë‹¤ìŒ ë Œë”ë§ ì´í›„ë¡œ ì—…ë°ì´íŠ¸ëœ ìƒíƒœã„¹ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ë°˜ë©´, `useRef`ë¡œ ê´€ë¦¬í•˜ê³  ìˆëŠ” ë³€ìˆ˜ëŠ” ì„¤ì • í›„ ë°”ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
  - `setTimeout`, `setInterval`ì„ í†µí•´ì„œ ë§Œë“¤ì–´ì§„ `id`
  - ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤
  - scroll ìœ„ì¹˜

```react
// App.js
import React, { useRef } from 'react';
import UserList from './UserList';

function App() {
  const users = [
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com'
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com'
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com'
    }
  ];

  const nextId = useRef(4);
  const onCreate = () => {
    // ë‚˜ì¤‘ì— êµ¬í˜„ í•  ë°°ì—´ì— í•­ëª© ì¶”ê°€í•˜ëŠ” ë¡œì§
    // ...

    nextId.current += 1;
  };
  return <UserList users={users} />;
}

export default App;
```

```react
// UserList.js
import React from 'react';

function User({ user }) {
  return (
    <div>
      <b>{user.username}</b> <span>({user.email})</span>
    </div>
  );
}

function UserList({ users }) {
  return (
    <div>
      {users.map(user => (
        <User user={user} key={user.id} />
      ))}
    </div>
  );
}

export default UserList;
```

- `useRef`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë¦¬ë Œë”ë§ ì—†ì´ ë³€ìˆ˜ê°’ì˜ ë³€í™”ë¥¼ ì´ìš©í•˜ê¸° ìœ„í•¨ì´ë‹¤!



-----



### 13. ë°°ì—´ì— í•­ëª© ì¶”ê°€í•˜ê¸°

```react
import React from 'react';

function CreateUser({ username, email, onChange, onCreate }) {
  return (
    <div>
      <input
        name="username"
        placeholder="ê³„ì •ëª…"
        onChange={onChange}
        value={username}
      />
      <input
        name="email"
        placeholder="ì´ë©”ì¼"
        onChange={onChange}
        value={email}
      />
      <button onClick={onCreate}>ë“±ë¡</button>
    </div>
  );
}

export default CreateUser;
```

```react
import React, { useRef, useState } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function App() {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = e => {
    const { name, value } = e.target;
    setInputs({
      ...inputs,
      [name]: value
    });
  };
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com'
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com'
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com'
    }
  ]);

  const nextId = useRef(4);
  const onCreate = () => {
    const user = {
      id: nextId.current,
      username,
      email
    };
    setUsers([...users, user]);
   	// concat í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤!!
    // concat í•¨ìˆ˜ëŠ” ê¸°ì¡´ì˜ ë°°ì—´ì„ ìˆ˜ì •í•˜ì§€ ì•Šê³ , ìƒˆë¡œìš´ ì›ì†Œê°€ ì¶”ê°€ëœ ìƒˆë¡œìš´ ë°°ì—´ì„ ë§Œë“¤ì–´ì¤€ë‹¤.
   	// setUsers(users.concat(user));
      

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  };
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} />
    </>
  );
}

export default App;
```

![image-20220615010736165](ë²¨ë¡œí¼íŠ¸2.assets/image-20220615010736165.png)





-----



### 14. ë°°ì—´ì— í•­ëª© ì œê±°í•˜ê¸°

```react
import React from 'react';

function User({ user, onRemove }) {
  return (
    <div>
      <b>{user.username}</b> <span>({user.email})</span>
      <button onClick={() => onRemove(user.id)}>ì‚­ì œ</button>
    </div>
  );
}

function UserList({ users, onRemove }) {
  return (
    <div>
      {users.map(user => (
        <User user={user} key={user.id} onRemove={onRemove}/>
      ))}
    </div>
  );
}

export default UserList;
```

```react
import React, { useRef, useState } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function App() {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = e => {
    const { name, value } = e.target;
    setInputs({
      ...inputs,
      [name]: value
    });
  };
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com'
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com'
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com'
    }
  ]);

  const nextId = useRef(4);
  const onCreate = () => {
    const user = {
      id: nextId.current,
      username,
      email
    };
    setUsers(users.concat(user));

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  };

  const onRemove = id => {
    // user.id ê°€ íŒŒë¼ë¯¸í„°ë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì›ì†Œë§Œ ì¶”ì¶œí•´ì„œ ìƒˆë¡œìš´ ë°°ì—´ì„ ë§Œë“¬
    // = user.id ê°€ id ì¸ ê²ƒì„ ì œê±°í•¨
    setUsers(users.filter(user => user.id !== id));
  };
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} onRemove={onRemove} />
    </>
  );
}

export default App;
```

- JSì—ì„œ filter í•¨ìˆ˜ : í•´ì„ ê·¸ëŒ€ë¡œ ê±¸ëŸ¬ì£¼ëŠ” ì—­í• ì„ í•œë‹¤. ì£¼ë¡œ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ìƒˆë¡œìš´ ë°°ì—´ì„ í•„ìš”ë¡œ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í¸.



----



### 15. ë°°ì—´ì— í•­ëª© ìˆ˜ì •í•˜ê¸°

```react
import React from 'react';

function User({ user, onRemove, onToggle }) {
  return (
    <div>
      <b
        style={{
          cursor: 'pointer',
          // userì˜ activeê°€ trueë©´ ì´ˆë¡ìƒ‰, falseë©´ ê²€ì •ìƒ‰ì´ ëœë‹¤.
          color: user.active ? 'green' : 'black'
        }}
        onClick={() => onToggle(user.id)}
      >
        {user.username}
      </b>
      &nbsp;
      <span>({user.email})</span>
      <button onClick={() => onRemove(user.id)}>ì‚­ì œ</button>
    </div>
  );
}

function UserList({ users, onRemove, onToggle }) {
  return (
    <div>
      {users.map(user => (
        <User
          user={user}
          key={user.id}
          onRemove={onRemove}
          onToggle={onToggle}
        />
      ))}
    </div>
  );
}

export default UserList;
```

```react
import React, { useRef, useState } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function App() {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = e => {
    const { name, value } = e.target;
    setInputs({
      ...inputs,
      [name]: value
    });
  };
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com',
      active: true
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com',
      active: false
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com',
      active: false
    }
  ]);

  const nextId = useRef(4);
  const onCreate = () => {
    const user = {
      id: nextId.current,
      username,
      email
    };
    setUsers(users.concat(user));

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  };

  const onRemove = id => {
    // user.id ê°€ íŒŒë¼ë¯¸í„°ë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì›ì†Œë§Œ ì¶”ì¶œí•´ì„œ ìƒˆë¡œìš´ ë°°ì—´ì„ ë§Œë“¬
    // = user.id ê°€ id ì¸ ê²ƒì„ ì œê±°í•¨
    setUsers(users.filter(user => user.id !== id));
  };
  const onToggle = id => {
    setUsers(
      users.map(user =>
        user.id === id ? { ...user, active: !user.active } : user
      )
    );
  };
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} onRemove={onRemove} onToggle={onToggle} />
    </>
  );
}

export default App;
```

![image-20220616015545744](ë²¨ë¡œí¼íŠ¸2.assets/image-20220616015545744.png)



-----



### 16. useEffectë¥¼ ì‚¬ìš©í•˜ì—¬ ë§ˆìš´íŠ¸/ì–¸ë§ˆìš´íŠ¸/ì—…ë°ì´íŠ¸ì‹œ í•  ì‘ì—… ì„¤ì •í•˜ê¸°

```react
import React, { useEffect } from 'react';

function User({ user, onRemove, onToggle }) {
  useEffect(() => {
    console.log('ì»´í¬ë„ŒíŠ¸ê°€ í™”ë©´ì— ë‚˜íƒ€ë‚¨');
    return () => {
      console.log('ì»´í¬ë„ŒíŠ¸ê°€ í™”ë©´ì—ì„œ ì‚¬ë¼ì§');
    };
  }, []);
    
    
  return (
    <div>
      <b
        style={{
          cursor: 'pointer',
          color: user.active ? 'green' : 'black'
        }}
        onClick={() => onToggle(user.id)}
      >
        {user.username}
      </b>
      &nbsp;
      <span>({user.email})</span>
      <button onClick={() => onRemove(user.id)}>ì‚­ì œ</button>
    </div>
  );
}

function UserList({ users, onRemove, onToggle }) {
  return (
    <div>
      {users.map(user => (
        <User
          user={user}
          key={user.id}
          onRemove={onRemove}
          onToggle={onToggle}
        />
      ))}
    </div>
  );
}

export default UserList;
```

- `useEffect` í•¨ìˆ˜ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë  ë•Œë§ˆë‹¤ íŠ¹ì • ì‘ì—…ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” Hookì´ë‹¤.
- `useEffect`ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” í•¨ìˆ˜, ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ì˜ì¡´ê°’ì´ ë“¤ì–´ìˆëŠ” ë°°ì—´(deps)ì„ ë„£ëŠ”ë‹¤. ë§Œì•½ì— `deps` ë°°ì—´ì„ ë¹„ìš°ê²Œ ëœë‹¤ë©´, ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë‚˜íƒ€ë‚  ë•Œì—ë§Œ `useEffect`ì— ë“±ë¡í•œ í•¨ìˆ˜ê°€ í˜¸ì¶œëœë‹¤.
  - ğŸ‘‰ ì»´í¬ë„ŒíŠ¸ê°€ í™”ë©´ì— ê°€ì¥ ì²˜ìŒ ë Œë”ë§ ë  ë•Œ í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ê³  ì‹¶ì„ ë•ŒëŠ” `deps` ìœ„ì¹˜ì— ë¹ˆ ë°°ì—´ì„ ë„£ëŠ”ë‹¤.
  - ğŸ‘‰ ë§Œì•½ ë°°ì—´ì„ ìƒëµí•œë‹¤ë©´ ë¦¬ë Œë”ë§ ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ëœë‹¤.

- ê·¸ë¦¬ê³  `useEffect`ì—ì„œëŠ” í•¨ìˆ˜ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆëŠ”ë° ì´ë¥¼ `cleanup` í•¨ìˆ˜ë¼ê³  ë¶€ë¥¸ë‹¤. `cleanup`í•¨ìˆ˜ëŠ” `useEffect`ì— ëŒ€í•œ ë’·ì •ë¦¬ë¥¼ í•´ì¤€ë‹¤ê³  ì´í•´í•˜ë©´ ëœë‹¤! `deps`ê°€ ë¹„ì–´ìˆëŠ” ê²½ìš° ì»´í¬ë„ŒíŠ¸ê°€ ì‚¬ë¼ì§ˆë•Œ `cleanup` í•¨ìˆ˜ê°€ í˜¸ì¶œëœë‹¤.

![image-20220616025306638](ë²¨ë¡œí¼íŠ¸2.assets/image-20220616025306638.png)

```react
import React, { useEffect } from 'react';

function User({ user, onRemove, onToggle }) {
  useEffect(() => {
    console.log(user);
  });
  return (
    <div>
      <b
        style={{
          cursor: 'pointer',
          color: user.active ? 'green' : 'black'
        }}
        onClick={() => onToggle(user.id)}
      >
        {user.username}
      </b>
      &nbsp;
      <span>({user.email})</span>
      <button onClick={() => onRemove(user.id)}>ì‚­ì œ</button>
    </div>
  );
}

function UserList({ users, onRemove, onToggle }) {
  return (
    <div>
      {users.map(user => (
        <User
          user={user}
          key={user.id}
          onRemove={onRemove}
          onToggle={onToggle}
        />
      ))}
    </div>
  );
}

export default UserList;
```

![image-20220616163536639](ë²¨ë¡œí¼íŠ¸2.assets/image-20220616163536639.png)





----



### 17. userMemoë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ì‚°í•œ ê°’ ì¬ì‚¬ìš©í•˜ê¸°

```mereact
import React, { useRef, useState, useMemo } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function countActiveUsers(users) {
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

function App() {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = e => {
    const { name, value } = e.target;
    setInputs({
      ...inputs,
      [name]: value
    });
  };
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com',
      active: true
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com',
      active: false
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com',
      active: false
    }
  ]);

  const nextId = useRef(4);
  const onCreate = () => {
    const user = {
      id: nextId.current,
      username,
      email
    };
    setUsers(users.concat(user));

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  };

  const onRemove = id => {
    // user.id ê°€ íŒŒë¼ë¯¸í„°ë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì›ì†Œë§Œ ì¶”ì¶œí•´ì„œ ìƒˆë¡œìš´ ë°°ì—´ì„ ë§Œë“¬
    // = user.id ê°€ id ì¸ ê²ƒì„ ì œê±°í•¨
    setUsers(users.filter(user => user.id !== id));
  };
  const onToggle = id => {
    setUsers(
      users.map(user =>
        user.id === id ? { ...user, active: !user.active } : user
      )
    );
  };
  const count = useMemo(() => countActiveUsers(users), [users]);
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} onRemove={onRemove} onToggle={onToggle} />
      <div>í™œì„±ì‚¬ìš©ì ìˆ˜ : {count}</div>
    </>
  );
}

export default App;
```

- `useMemo` : ì»´í¬ë„ŒíŠ¸ì˜ ì„±ëŠ¥ì„ ìµœì í™”ì‹œí‚¬ ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì€ react hooks ì¤‘ í•˜ë‚˜. 
  - MemoëŠ” Memoizationì„ ì˜ë¯¸. memoizationì´ë€ ê¸°ì¡°ì— ìˆ˜í–‰í•œ ì—°ì‚°ì˜ ê²°ê´ê°’ì„ ì–´ë”˜ê°€ì— ì €ì¥í•´ ë‘ê³  ë™ì¼í•œ ì…ë ¥ì´ ë“¤ì–´ì˜¤ë©´ ì¬í™œìš©í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ë²•ì„ ì˜ë¯¸.

![image-20220616173251249](ë²¨ë¡œí¼íŠ¸2.assets/image-20220616173251249.png)





----



### 18. useCallbackì„ ì‚¬ìš©í•˜ì—¬ í•¨ìˆ˜ ì¬ì‚¬ìš©í•˜ê¸°

- `useMemo`ëŠ” íŠ¹ì • ê²°ê³¼ê°’ì„ ì¬ì‚¬ìš©í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°˜ë©´, `useCallback`ì€ íŠ¹ì • í•¨ìˆ˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ì§€ ì•Šê³  ì¬ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.

```react
import React, { useRef, useState, useMemo, useCallback } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function countActiveUsers(users) {
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

function App() {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = useCallback(
    e => {
      const { name, value } = e.target;
      setInputs({
        ...inputs,
        [name]: value
      });
    },
    [inputs]
  );
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com',
      active: true
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com',
      active: false
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com',
      active: false
    }
  ]);

  const nextId = useRef(4);
  const onCreate = useCallback(() => {
    const user = {
      id: nextId.current,
      username,
      email
    };
    setUsers(users.concat(user));

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  }, [users, username, email]);

  const onRemove = useCallback(
    id => {
      // user.id ê°€ íŒŒë¼ë¯¸í„°ë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì›ì†Œë§Œ ì¶”ì¶œí•´ì„œ ìƒˆë¡œìš´ ë°°ì—´ì„ ë§Œë“¬
      // = user.id ê°€ id ì¸ ê²ƒì„ ì œê±°í•¨
      setUsers(users.filter(user => user.id !== id));
    },
    [users]
  );
  const onToggle = useCallback(
    id => {
      setUsers(
        users.map(user =>
          user.id === id ? { ...user, active: !user.active } : user
        )
      );
    },
    [users]
  );
  const count = useMemo(() => countActiveUsers(users), [users]);
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} onRemove={onRemove} onToggle={onToggle} />
      <div>í™œì„±ì‚¬ìš©ì ìˆ˜ : {count}</div>
    </>
  );
}

export default App;
```

- ì£¼ì˜í•  ì !!! í•¨ìˆ˜ ì•ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ìƒíƒœ í˜¹ì€ propsê°€ ìˆë‹¤ë©´ ê¼­, `deps` ë°°ì—´ì•ˆì— í¬í•¨ì‹œì¼œì•¼ ëœë‹¤ëŠ” ê²ƒ.
- ë§Œì•½ì— `deps` ë°°ì—´ ì•ˆì— í•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°’ì„ ë„£ì§€ ì•Šê²Œ ëœë‹¤ë©´, í•¨ìˆ˜ ë‚´ì—ì„œ í•´ë‹¹ ê°’ë“¤ì„ ì°¸ì¡°í•  ë•Œ ê°€ì¥ ìµœì‹  ê°’ì„ ì°¸ì¡°í•  ê²ƒì´ë¼ê³  ë³´ì¥í•  ìˆ˜ ì—†ë‹¤. propsë¡œ ë°›ì•„ì˜¨ í•¨ìˆ˜ê°€ ìˆë‹¤ë©´, ì´ ë˜í•œ `deps` ì•ˆì— ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.
- ì‚¬ì‹¤ `useCallback`ì€ `useMemo`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œë‹¤. ë‹¤ë§Œ, í•¨ìˆ˜ë¥¼ ìœ„í•´ì„œ ì‚¬ìš©í•  ë•Œ ë”ìš± í¸í•˜ê²Œ í•´ì¤€ ê²ƒì´ë‹¤.



----



### 19. React.memoë¥¼ ì‚¬ìš©í•œ ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§ ë°©ì§€

- `React.memo` í•¨ìˆ˜ = ì»´í¬ë„ŒíŠ¸ì˜ propsê°€ ë°”ë€Œì§€ ì•Šì•˜ë‹¤ë©´, ë¦¬ë Œë”ë§ì„ ë°©ì§€í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ë Œë”ë§ ì„±ëŠ¥ ìµœì í™”ë¥¼ í•´ì¤„ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í•¨ìˆ˜!
- ì ìš© ë°©ë²•ì€ êµ‰ì¥íˆ ì‰½ë‹¤! ë§ˆì§€ë§‰ì— exportì—ì„œ `React.memo`ë¡œ ê°ì‹¸ì£¼ë©´ ë

```react
export default React.memo(CreateUser);

export default React.memo(UserList);
```

- í•˜ì§€ë§Œ,  ìœ„ì˜ ì˜ˆì‹œ ì½”ë“œë¡œ ë³´ë©´ App.js ë‚´ë¶€ì— ì‘ì„±ëœ í•¨ìˆ˜ë“¤ ì¤‘ `useCallback`ì´ ì ìš©ëœ í•¨ìˆ˜ì— deps íŒŒíŠ¸ë¡œ usersê°€ ë“¤ì–´ìˆì–´ users ë°°ì—´ì´ ë°”ë€” ë•Œë§ˆë‹¤ í•¨ìˆ˜ê°€ ìƒˆë¡œ ë§Œë“¤ì–´ì ¸ ë¦¬ë Œë”ë§ì´ ëœë‹¤. ì´ê±¸ ìµœì í™”í•˜ê³  ì‹¶ë‹¤ë©´?? ğŸ‘‰ depsì— ìˆëŠ” usersë¥¼ ì§€ìš°ê³ , í•¨ìˆ˜ë“¤ì—ì„œ í˜„ì¬ `useState`ë¡œ ê´€ë¦¬í•˜ëŠ” usersë¥¼ ì°¸ì¡°í•˜ì§€ ì•Šê²Œ í•˜ëŠ” ê²ƒ.
- ê·¸ê²ƒì€ ë°”ë¡œ `í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸` !!! í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ë¥¼ í•˜ê²Œ ë˜ë©´, setUsersì— ë“±ë¡í•˜ëŠ” ì½œë°±í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ì—ì„œ ìµœì‹  usersë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— depsì— usersë¥¼ ë„£ì§€ ì•Šì•„ë„ ëœë‹¤.

```react
import React, { useRef, useState, useMemo, useCallback } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function countActiveUsers(users) {
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

function App() {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = useCallback(e => {
    const { name, value } = e.target;
    setInputs(inputs => ({
      ...inputs,
      [name]: value
    }));
  }, []);
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com',
      active: true
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com',
      active: false
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com',
      active: false
    }
  ]);

  const nextId = useRef(4);
  const onCreate = useCallback(() => {
    const user = {
      id: nextId.current,
      username,
      email
    };
    // ì—¬ê¸°ë¥¼ ì£¼ëª©í•˜ë¼
    setUsers(users => users.concat(user));

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  }, [username, email]);

  const onRemove = useCallback(id => {
    // user.id ê°€ íŒŒë¼ë¯¸í„°ë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ì›ì†Œë§Œ ì¶”ì¶œí•´ì„œ ìƒˆë¡œìš´ ë°°ì—´ì„ ë§Œë“¬
    // = user.id ê°€ id ì¸ ê²ƒì„ ì œê±°í•¨
      
    // ì—¬ê¸°ë¥¼ ì£¼ëª©í•˜ë¼
    setUsers(users => users.filter(user => user.id !== id));
  }, []);
  // ì—¬ê¸°ë¥¼ ì£¼ëª©í•˜ë¼
  const onToggle = useCallback(id => {
    setUsers(users =>
      users.map(user =>
        user.id === id ? { ...user, active: !user.active } : user
      )
    );
  }, []);
  const count = useMemo(() => countActiveUsers(users), [users]);
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} onRemove={onRemove} onToggle={onToggle} />
      <div>í™œì„±ì‚¬ìš©ì ìˆ˜ : {count}</div>
    </>
  );
}

export default App;
```





-----



### 20. useReducerë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§ ë¶„ë¦¬í•˜ê¸°

- ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œì—ëŠ” `useState`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ì™¸ì—ë„ `useReducer`ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤! ì´ ë‘˜ì„ ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì—ì„œ ì–´ë–¤ ê²ƒì„ ì¨ì•¼í•œë‹¤, ë¼ëŠ” ì •ë‹µì€ ì—†ì§€ë§Œ ìƒí™©ì— ë”°ë¼ ë” í¸ë¦¬í•˜ê²Œ ëŠê»´ì§€ëŠ” ê²ƒì´ ìˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°’ì´ ë”± í•˜ë‚˜ê³ , ê·¸ ê°’ì´ ë‹¨ìˆœí•œ ìˆ«ì, ë¬¸ìì—´ ë˜ëŠ” boolean ê°’ì´ë¼ë©´ í™•ì‹¤íˆ `useState`ë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ í¸í•  ê²ƒì´ë‹¤.
- í•˜ì§€ë§Œ, ë§Œì•½ì— ì»´í¬ë„ŒíŠ¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°’ì´ ì—¬ëŸ¬ ê°œê°€ ë˜ì–´ì„œ ìƒíƒœì˜ êµ¬ì¡°ê°€ ë³µì¡í•´ì§„ë‹¤ë©´ `useReducer`ë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ í¸í•´ì§ˆ ìˆ˜ë„ ìˆë‹¤.

```react
import React, { useRef, useReducer, useMemo, useCallback } from 'react';
import UserList from './UserList';
import CreateUser from './CreateUser';

function countActiveUsers(users) {
  console.log('í™œì„± ì‚¬ìš©ì ìˆ˜ë¥¼ ì„¸ëŠ”ì¤‘...');
  return users.filter(user => user.active).length;
}

const initialState = {
  inputs: {
    username: '',
    email: ''
  },
  users: [
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com',
      active: true
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com',
      active: false
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com',
      active: false
    }
  ]
};

function reducer(state, action) {
  switch (action.type) {
    case 'CHANGE_INPUT':
      return {
        ...state,
        inputs: {
          ...state.inputs,
          [action.name]: action.value
        }
      };
    case 'CREATE_USER':
      return {
        inputs: initialState.inputs,
        users: state.users.concat(action.user)
      };
    case 'TOGGLE_USER':
      return {
        ...state,
        users: state.users.map(user =>
          user.id === action.id ? { ...user, active: !user.active } : user
        )
      };
    case 'REMOVE_USER':
      return {
        ...state,
        users: state.users.filter(user => user.id !== action.id)
      };
    default:
      return state;
  }
}

function App() {
  const [state, dispatch] = useReducer(reducer, initialState);
  const nextId = useRef(4);

  const { users } = state;
  const { username, email } = state.inputs;

  const onChange = useCallback(e => {
    const { name, value } = e.target;
    dispatch({
      type: 'CHANGE_INPUT',
      name,
      value
    });
  }, []);

  const onCreate = useCallback(() => {
    dispatch({
      type: 'CREATE_USER',
      user: {
        id: nextId.current,
        username,
        email
      }
    });
    nextId.current += 1;
  }, [username, email]);

  const onToggle = useCallback(id => {
    dispatch({
      type: 'TOGGLE_USER',
      id
    });
  }, []);

  const onRemove = useCallback(id => {
    dispatch({
      type: 'REMOVE_USER',
      id
    });
  }, []);

  const count = useMemo(() => countActiveUsers(users), [users]);
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} onToggle={onToggle} onRemove={onRemove} />
      <div>í™œì„±ì‚¬ìš©ì ìˆ˜ : {count}</div>
    </>
  );
}

export default App;
```

